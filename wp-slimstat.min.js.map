{
  "version": 3,
  "sources": ["wp-slimstat.js"],
  "sourcesContent": ["// NOTE: Fingerprint2 (fingerprintjs2) library is required as a global dependency\n// and should be loaded before this script\n\n/**\n * SlimStat: Browser tracking helper (refactored for maintainability)\n * Public API surface preserved (SlimStat.*) while internals modernized and scoped.\n * NOTE: Legacy browsers still supported via simple polyfills below.\n */\n// eslint-disable-next-line no-var\nvar SlimStat = (function () {\n    var BASE64_KEY_STR = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789._-\";\n    var fingerprintHash = \"\";\n    var lastPageviewPayload = \"\";\n    var lastPageviewSentAt = 0;\n    var inflightPageview = false;\n    // Queue to enforce sequential sending order for tracking requests\n    var requestQueue = [];\n    var queueInFlight = false;\n    var MAX_QUEUE_ATTEMPTS = 4;\n    var QUEUE_HIGH_WATERMARK = 80; // drop low-priority if exceeded\n    var lastInteractionPayload = \"\";\n    var lastInteractionTime = 0;\n    var PENDING_INTERACTIONS_LIMIT = 20;\n    var pendingInteractions = [];\n\n    function bufferInteraction(raw) {\n        if (pendingInteractions.length >= PENDING_INTERACTIONS_LIMIT) pendingInteractions.shift();\n        pendingInteractions.push(raw);\n    }\n\n    function flushPendingInteractions() {\n        if (!pendingInteractions.length) return;\n        var params = currentSlimStatParams();\n        if (!params.id || parseInt(params.id, 10) <= 0) return; // still can't flush\n        while (pendingInteractions.length) {\n            var raw = pendingInteractions.shift();\n            var payload = \"action=slimtrack&id=\" + params.id + raw;\n            sendToServer(payload, true, { priority: \"normal\" });\n        }\n    }\n\n    // Offline persistence helpers\n    var OFFLINE_KEY = \"slimstat_offline_queue\";\n    function loadOfflineQueue() {\n        try {\n            var raw = localStorage.getItem(OFFLINE_KEY);\n            if (!raw) return [];\n            var arr = JSON.parse(raw);\n            return Array.isArray(arr) ? arr : [];\n        } catch (e) {\n            return [];\n        }\n    }\n    function saveOfflineQueue(arr) {\n        try {\n            localStorage.setItem(OFFLINE_KEY, JSON.stringify(arr.slice(-200))); // cap\n        } catch (e) {\n            /* ignore */\n        }\n    }\n    function storeOffline(payload) {\n        var arr = loadOfflineQueue();\n        arr.push({ p: payload, t: Date.now() });\n        saveOfflineQueue(arr);\n    }\n    function flushOfflineQueue() {\n        var arr = loadOfflineQueue();\n        if (!arr.length) return;\n        saveOfflineQueue([]); // clear first to avoid loops\n        arr.forEach(function (item) {\n            sendToServer(item.p, true, { priority: \"normal\" });\n        });\n    }\n\n    // -------------------------- Generic Helpers -------------------------- //\n    function utf8Encode(string) {\n        string = (string || \"\").replace(/\\r\\n/g, \"\\n\");\n        var utftext = \"\";\n        for (var n = 0; n < string.length; n++) {\n            var c = string.charCodeAt(n);\n            if (c < 128) utftext += String.fromCharCode(c);\n            else if (c < 2048) {\n                utftext += String.fromCharCode((c >> 6) | 192, (c & 63) | 128);\n            } else {\n                utftext += String.fromCharCode((c >> 12) | 224, ((c >> 6) & 63) | 128, (c & 63) | 128);\n            }\n        }\n        return utftext;\n    }\n\n    function base64Encode(input) {\n        var output = \"\";\n        var i = 0;\n        input = utf8Encode(input);\n        while (i < input.length) {\n            var chr1 = input.charCodeAt(i++);\n            var chr2 = input.charCodeAt(i++);\n            var chr3 = input.charCodeAt(i++);\n            var enc1 = chr1 >> 2;\n            var enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);\n            var enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n            var enc4 = chr3 & 63;\n            if (isNaN(chr2)) enc3 = enc4 = 64;\n            else if (isNaN(chr3)) enc4 = 64;\n            output += BASE64_KEY_STR.charAt(enc1) + BASE64_KEY_STR.charAt(enc2) + BASE64_KEY_STR.charAt(enc3) + BASE64_KEY_STR.charAt(enc4);\n        }\n        return output;\n    }\n\n    function isEmpty(v) {\n        if (v === undefined || v === null) return true;\n        var t = typeof v;\n        if (t === \"boolean\") return !v;\n        if (t === \"number\") return isNaN(v) || v === 0;\n        if (t === \"string\") return v.length === 0;\n        if (Array.isArray(v)) return v.length === 0;\n        if (t === \"object\") return Object.keys(v).length === 0;\n        return false;\n    }\n\n    function anySubstring(str, needles) {\n        if (!str || !needles || !needles.length) return false;\n        for (var i = 0; i < needles.length; i++) {\n            if (str.indexOf(needles[i].trim()) !== -1) return true;\n        }\n        return false;\n    }\n\n    function getCookie(name) {\n        var value = \"; \" + document.cookie;\n        var parts = value.split(\"; \" + name + \"=\");\n        if (parts.length === 2) return parts.pop().split(\";\").shift();\n        return \"\";\n    }\n\n    function addEvent(obj, type, fn) {\n        if (!obj) return;\n        if (obj.addEventListener) obj.addEventListener(type, fn, false);\n        else if (obj.attachEvent) obj.attachEvent(\"on\" + type, fn);\n        else obj[\"on\" + type] = fn;\n    }\n\n    function getServerLatency() {\n        var timing = (window.performance || {}).timing || {};\n        if (!timing.responseEnd || !timing.connectEnd) return 0;\n        return timing.responseEnd - timing.connectEnd;\n    }\n\n    function getPagePerformance() {\n        var timing = (window.performance || {}).timing || {};\n        if (!timing.loadEventEnd || !timing.responseEnd) return 0;\n        return timing.loadEventEnd - timing.responseEnd;\n    }\n\n    function getComponentValue(components, key, def) {\n        // FingerprintJS v4 API - components is now an object with component names as keys\n        if (components && components[key] && components[key].value !== undefined) {\n            return components[key].value;\n        }\n        return def;\n    }\n\n    // This function will be defined in the outer scope and assigned to SlimStat\n    // function currentSlimStatParams() { ... }\n\n    // -------------------------- Parameters Extraction -------------------------- //\n    function extractSlimStatParams() {\n        var meta = document.querySelector('meta[name=\"slimstat-params\"]');\n        if (meta) {\n            try {\n                window.SlimStatParams = JSON.parse(meta.getAttribute(\"content\")) || {};\n            } catch (e) {\n                /* ignore */\n            }\n        } else {\n            // Fallback: look through inline scripts (same as legacy)\n            var scripts = document.querySelectorAll(\"script\");\n            for (var i = scripts.length - 1; i >= 0; i--) {\n                var match = scripts[i].textContent.match(/var\\s+SlimStatParams\\s*=\\s*({[\\s\\S]*?});/);\n                if (match) {\n                    try {\n                        // eslint-disable-next-line no-new-func\n                        window.SlimStatParams = new Function(\"return \" + match[1])() || {};\n                        break;\n                    } catch (e) {\n                        /* ignore */\n                    }\n                }\n            }\n        }\n        return currentSlimStatParams();\n    }\n\n    // -------------------------- Fingerprint -------------------------- //\n    function initFingerprintHash(result) {\n        try {\n            // FingerprintJS v4 API - result contains visitorId and components\n            if (result && result.visitorId) {\n                fingerprintHash = result.visitorId;\n                return;\n            }\n            // Graceful fallback\n            fingerprintHash = \"\";\n        } catch (e) {\n            fingerprintHash = \"\"; // graceful fallback\n        }\n    }\n\n    function buildSlimStatData(components) {\n        // Components are optional; compute directly if not provided\n        // FingerprintJS v4 returns components as an object, not an array\n        var hasComponents = components && typeof components === \"object\" && !Array.isArray(components);\n\n        var screenres = [0, 0];\n        try {\n            if (hasComponents) {\n                screenres = getComponentValue(components, \"screenResolution\", [0, 0]);\n            }\n            // Fallback to window.screen if components not available or screenResolution not found\n            if (!screenres || screenres[0] === 0) {\n                if (window.screen) {\n                    screenres = [window.screen.width || 0, window.screen.height || 0];\n                }\n            }\n        } catch (e) {\n            screenres = [0, 0];\n        }\n\n        var tzOffset = 0;\n        try {\n            if (hasComponents) {\n                tzOffset = getComponentValue(components, \"timezoneOffset\", 0);\n            }\n            // Fallback to Date API if components not available or timezoneOffset not found\n            if (tzOffset === 0 && !hasComponents) {\n                tzOffset = new Date().getTimezoneOffset();\n            }\n        } catch (e) {\n            tzOffset = 0;\n        }\n\n        return \"&sw=\" + screenres[0] + \"&sh=\" + screenres[1] + \"&bw=\" + window.innerWidth + \"&bh=\" + window.innerHeight + \"&sl=\" + getServerLatency() + \"&pp=\" + getPagePerformance() + \"&fh=\" + fingerprintHash + \"&tz=\" + tzOffset;\n    }\n\n    // -------------------------- Transport -------------------------- //\n    function sendToServer(payload, useBeacon, opts) {\n        if (isEmpty(payload)) return false;\n        opts = opts || {};\n\n        // All requests now go through the queue to ensure consistent handling.\n        // Immediate sends are pushed to the front.\n        var item = { payload: payload, useBeacon: useBeacon, opts: opts, attempts: 0 };\n\n        // Check for duplicate payloads in queue to prevent duplicates\n        var isDuplicate = requestQueue.some(function (qItem) {\n            return qItem.payload === payload;\n        });\n        if (isDuplicate) {\n            return false;\n        }\n\n        // Queue pressure control: drop oldest non-high if above high watermark\n        if (requestQueue.length > QUEUE_HIGH_WATERMARK) {\n            for (var i = requestQueue.length - 1; i >= 0 && requestQueue.length > QUEUE_HIGH_WATERMARK; i--) {\n                if (requestQueue[i].opts.priority !== \"high\") requestQueue.splice(i, 1);\n            }\n        }\n\n        if (opts.immediate || opts.priority === \"high\") {\n            // Avoid duplicates of same payload at head\n            if (!requestQueue.length || requestQueue[0].payload !== payload) {\n                requestQueue.unshift(item);\n            }\n        } else {\n            requestQueue.push(item);\n        }\n\n        // Start processing if not already running\n        if (!queueInFlight) {\n            processQueue();\n        }\n\n        return true;\n    }\n\n    function processQueue() {\n        if (queueInFlight || !requestQueue.length) return;\n        var item = requestQueue.shift();\n        if (!item) return;\n\n        queueInFlight = true;\n\n        var done = function (success) {\n            if (!success && item) {\n                item.attempts = (item.attempts || 0) + 1;\n                if (item.attempts < MAX_QUEUE_ATTEMPTS) {\n                    // Re-queue with a delay and exponential backoff\n                    var delay = 500 * Math.pow(2, item.attempts);\n                    setTimeout(function () {\n                        requestQueue.unshift(item);\n                    }, delay);\n                } else {\n                    // Max attempts reached, move to offline storage\n                    SlimStat.store_offline(item.payload);\n                    if (item.opts && typeof item.opts.onComplete === \"function\") {\n                        item.opts.onComplete(false);\n                    }\n                }\n            } else {\n                if (item.opts && typeof item.opts.onComplete === \"function\") {\n                    item.opts.onComplete(!!success);\n                }\n            }\n            queueInFlight = false;\n            // Process next after a micro delay to allow ID assignment, etc.\n            setTimeout(processQueue, 50); // increased delay to prevent tight loops on failure\n        };\n\n        processQueueItem(item, done);\n    }\n\n    function processQueueItem(item, callback) {\n        var params = currentSlimStatParams();\n        var payload = item.payload;\n        var useBeacon = item.useBeacon;\n        var transports = [\"rest\", \"ajax\", \"adblock_bypass\"];\n        var endpoints = { rest: params.ajaxurl_rest, ajax: params.ajaxurl_ajax, adblock_bypass: params.ajaxurl_adblock };\n        var selected = params.transport;\n        var order = [selected].concat(\n            transports.filter(function (t) {\n                return t !== selected;\n            })\n        );\n        function sendXHR(url, onFail, xhrOpts) {\n            xhrOpts = xhrOpts || { useNonce: true };\n            var xhr;\n            try {\n                xhr = new XMLHttpRequest();\n            } catch (e) {\n                if (onFail) onFail();\n                return false;\n            }\n            xhr.open(\"POST\", url, true);\n            xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n            xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n            if (xhrOpts.useNonce && params.wp_rest_nonce) xhr.setRequestHeader(\"X-WP-Nonce\", params.wp_rest_nonce);\n            xhr.withCredentials = true;\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4) {\n                    // Special handling for nonce failure: retry immediately without nonce\n                    if (xhr.status === 403 && xhrOpts.useNonce && params.wp_rest_nonce) {\n                        // To prevent loops, we only retry once without the nonce.\n                        // The onFail logic will be handled by the retry's result.\n                        sendXHR(url, onFail, { useNonce: false });\n                        return;\n                    }\n                    if (xhr.status === 200) {\n                        var parsed = parseInt(xhr.responseText, 10);\n                        if (!isNaN(parsed) && parsed > 0) {\n                            params.id = xhr.responseText; // store new id\n                            // Mark that we've successfully tracked the initial pageview for this load\n                            try {\n                                window.slimstatPageviewTracked = true;\n                            } catch (trackErr) {\n                                /* ignore */\n                            }\n                            flushPendingInteractions(); // Flush buffered interactions now that we have an ID\n                        }\n                        callback(true);\n                    } else {\n                        // Non-200 status is a failure, trigger retry/failover\n                        if (onFail) onFail();\n                    }\n                }\n            };\n            try {\n                xhr.send(payload);\n            } catch (e) {\n                // This catches network errors before send, also a failure\n                if (onFail) onFail();\n            }\n            return true;\n        }\n        function trySend(i) {\n            if (i >= order.length) {\n                // All transport methods have been tried and failed\n                callback(false);\n                return false;\n            }\n            var method = order[i];\n            var url = endpoints[method];\n            if (!url) return trySend(i + 1);\n            if (useBeacon && navigator.sendBeacon && i === 0) {\n                // Beacon is fire-and-forget; we assume success for queue processing\n                var ok = navigator.sendBeacon(url, payload);\n                if (ok) {\n                    callback(true);\n                    return true;\n                }\n                // If beacon fails, immediately try next method\n                return trySend(i + 1);\n            }\n            return sendXHR(\n                url,\n                function () {\n                    trySend(i + 1);\n                },\n                { useNonce: true }\n            );\n        }\n        trySend(0);\n    }\n\n    // -------------------------- Interaction Tracking -------------------------- //\n    function trackInteraction(event, note, useBeacon) {\n        var params = currentSlimStatParams();\n        if (isEmpty(params.id) || isNaN(parseInt(params.id, 10)) || parseInt(params.id, 10) <= 0) {\n            // Buffer interaction until we have an id\n            try {\n                var minimal = buildInteractionRaw(event, note);\n                bufferInteraction(minimal);\n            } catch (e) {\n                /* ignore */\n            }\n            return false;\n        }\n        if (!event || isEmpty(event.type) || event.type === \"focus\") return false;\n\n        useBeacon = typeof useBeacon === \"boolean\" ? useBeacon : true;\n        var target = event.target || event.srcElement;\n        if (!target) return false;\n\n        var noteObj = {};\n        if (!isEmpty(note)) noteObj.note = note;\n\n        // Derive resource URL\n        var resourceUrl = \"\";\n        (function derive() {\n            if (!target.nodeName) return;\n            var node = target.nodeName.toLowerCase();\n            if (node === \"input\" || node === \"button\") {\n                var p = target.parentNode;\n                while (p && p.nodeName && p.nodeName.toLowerCase() !== \"form\") p = p.parentNode;\n                if (p && p.action) resourceUrl = p.action;\n                return;\n            }\n            // anchor resolution (support nested nodes)\n            if (!target.href || typeof target.href !== \"string\") {\n                var p = target.parentNode;\n                while (p && p.nodeName && !p.href) p = p.parentNode;\n                if (p) {\n                    if (p.hash && p.hostname === location.hostname) resourceUrl = p.hash;\n                    else if (p.href) resourceUrl = p.href;\n                }\n            } else if (target.hash) resourceUrl = target.hash;\n            else resourceUrl = target.href;\n        })();\n\n        // Element attributes\n        if (typeof target.getAttribute === \"function\") {\n            if (target.textContent) noteObj.text = target.textContent;\n            var val = target.getAttribute(\"value\");\n            if (val) noteObj.value = val;\n            var title = target.getAttribute(\"title\");\n            if (title) noteObj.title = title;\n            var idAttr = target.getAttribute(\"id\");\n            if (idAttr) noteObj.id = idAttr;\n        }\n        noteObj.type = event.type;\n        if (event.type === \"keypress\") noteObj.key = String.fromCharCode(parseInt(event.which, 10));\n        else if (event.type === \"mousedown\") noteObj.button = event.which === 1 ? \"left\" : event.which === 2 ? \"middle\" : \"right\";\n\n        var doNotTrack = params.dnt ? params.dnt.split(\",\") : [];\n        if (resourceUrl && doNotTrack.length && anySubstring(resourceUrl, doNotTrack)) return false;\n\n        // class-based do not track\n        if (doNotTrack.length && target.className && typeof target.className === \"string\") {\n            var classes = target.className.split(\" \");\n            if (classes.some((c) => doNotTrack.indexOf(c) !== -1)) return false;\n        }\n        if (doNotTrack.length && target.attributes && target.attributes.rel && target.attributes.rel.value) {\n            if (anySubstring(target.attributes.rel.value, doNotTrack)) return false;\n        }\n\n        // Coordinates\n        var position = \"0,0\";\n        if (!isEmpty(event.pageX) && !isEmpty(event.pageY)) position = event.pageX + \",\" + event.pageY;\n        else if (!isEmpty(event.clientX)) position = event.clientX + (document.body.scrollLeft || 0) + (document.documentElement.scrollLeft || 0) + \",\" + (event.clientY + (document.body.scrollTop || 0) + (document.documentElement.scrollTop || 0));\n\n        var fingerprintParam = resourceUrl ? \"&fh=\" + fingerprintHash : \"\";\n        var raw = \"&res=\" + base64Encode(resourceUrl) + \"&pos=\" + position + \"&no=\" + base64Encode(JSON.stringify(noteObj)) + fingerprintParam;\n        var payload = \"action=slimtrack&id=\" + params.id + raw;\n        var now = Date.now();\n        if (payload === lastInteractionPayload && now - lastInteractionTime < 1000) return false; // dedupe bursts\n        lastInteractionPayload = payload;\n        lastInteractionTime = now;\n        var sent = sendToServer(payload, useBeacon);\n        if (sent) {\n            // Flag that at least one meaningful interaction happened this pageview\n            try {\n                window.__slimstatHasInteraction = true;\n            } catch (e) {\n                /* ignore */\n            }\n        }\n        return sent;\n    }\n\n    function buildInteractionRaw(event, note) {\n        // Reconstruct minimal raw (without id) for buffering.\n        var target = (event && (event.target || event.srcElement)) || {};\n        var resourceUrl = \"\";\n        try {\n            if (target.href) resourceUrl = target.href;\n        } catch (e) {\n            /* ignore */\n        }\n        var noteObj = { type: event ? event.type : \"unknown\" };\n        if (note) noteObj.note = note;\n        var position = \"0,0\";\n        if (event && !isEmpty(event.pageX) && !isEmpty(event.pageY)) position = event.pageX + \",\" + event.pageY;\n        return \"&res=\" + base64Encode(resourceUrl) + \"&pos=\" + position + \"&no=\" + base64Encode(JSON.stringify(noteObj));\n    }\n\n    // -------------------------- Pageview Logic -------------------------- //\n    // FP_EXCLUDES retained for backward compatibility, not used by FingerprintJS v4\n    var FP_EXCLUDES = {};\n\n    // -------------------------- Consent Helpers -------------------------- //\n    var lastConsentSnapshot = null;\n\n    function isFunction(value) {\n        return typeof value === \"function\";\n    }\n\n    function isObject(value) {\n        return value !== null && typeof value === \"object\";\n    }\n\n    function getCookieStrict(name) {\n        if (!name) return null;\n        try {\n            var safeName = name.replace(/([.$?*|{}()\\[\\]\\\\\\/\\+^])/g, \"\\\\$1\");\n            var pattern = \"(?:^|;)\\\\s*\" + safeName + \"=([^;]*)\";\n            var match = document.cookie.match(pattern);\n            return match ? decodeURIComponent(match[1]) : null;\n        } catch (e) {\n            return null;\n        }\n    }\n\n    function detectRealCookieBannerConsent(category) {\n        try {\n            // Latest API (RCB 4.x+): window.rcb() function\n            if (isFunction(window.rcb)) {\n                try {\n                    var rcbConsent = window.rcb(\"consent\", category);\n                    if (rcbConsent === true || rcbConsent === false) return !!rcbConsent;\n                    if (isObject(rcbConsent) && \"cookie\" in rcbConsent) return !!rcbConsent.cookie;\n                    if (isObject(rcbConsent) && \"consent\" in rcbConsent) return !!rcbConsent.consent;\n                } catch (e) {\n                    /* ignore */\n                }\n            }\n\n            // New API: window.RCB.consent.get()\n            if (isObject(window.RCB) && isObject(window.RCB.consent) && isFunction(window.RCB.consent.get)) {\n                var rcbNew = window.RCB.consent.get(category);\n                if (rcbNew === true || rcbNew === false) return !!rcbNew;\n                if (isObject(rcbNew) && \"cookie\" in rcbNew) return !!rcbNew.cookie;\n                if (isObject(rcbNew) && \"consent\" in rcbNew) return !!rcbNew.consent;\n            }\n\n            // Current API: window.rcbConsentManager.getUserDecision()\n            if (isObject(window.rcbConsentManager) && isFunction(window.rcbConsentManager.getUserDecision)) {\n                var decision = window.rcbConsentManager.getUserDecision();\n                if (decision && decision.decision) {\n                    if (decision.decision === \"all\") return true;\n                    if (typeof decision.decision === \"object\") {\n                        var value = decision.decision[category];\n                        if (typeof value === \"boolean\") return value;\n                        if (Array.isArray(value)) return value.length > 0;\n                    }\n                }\n            }\n\n            // Legacy API: window.realCookieBanner.consent.get()\n            var rcb = window.realCookieBanner || window.RealCookieBanner || null;\n            if (isObject(rcb) && isObject(rcb.consent) && isFunction(rcb.consent.get)) {\n                var consent = rcb.consent.get(category);\n                if (consent === true || consent === false) return !!consent;\n                if (isObject(consent) && \"cookie\" in consent) return !!consent.cookie;\n                if (consent) return true;\n            }\n\n            // Very old API: window.__rcb\n            var legacy = window.__rcb || window.__RCB || null;\n            if (isObject(legacy) && legacy.consent) {\n                var legacyVal = legacy.consent[category];\n                if (typeof legacyVal === \"boolean\") return legacyVal;\n                if (Array.isArray(legacyVal)) return legacyVal.length > 0;\n            }\n\n            // Cookie fallback\n            var possibleNames = [\"real_cookie_banner\", \"rcb_consent\", \"rcb_acceptance\", \"real_cookie_consent\", \"rcb-consent\"];\n            for (var i = 0; i < possibleNames.length; i++) {\n                var raw = getCookieStrict(possibleNames[i]);\n                if (!raw) {\n                    continue;\n                }\n                try {\n                    var parsed = JSON.parse(raw);\n                    if (parsed) {\n                        if (typeof parsed[category] === \"boolean\") return parsed[category];\n                        if (typeof parsed.consent === \"boolean\") return parsed.consent;\n                        if (typeof parsed[category] === \"object\" && parsed[category].cookie !== undefined) return !!parsed[category].cookie;\n                    }\n                } catch (err) {\n                    var normalized = raw.toLowerCase();\n                    if (raw.indexOf(category) !== -1 || raw === \"1\" || normalized === \"true\" || normalized === \"all\" || normalized === \"accepted\") {\n                        return true;\n                    }\n                }\n            }\n        } catch (error) {\n            /* ignore */\n        }\n        return null;\n    }\n\n    function detectWPConsentAPI(category) {\n        try {\n            if (isFunction(window.wp_has_service_consent)) {\n                try {\n                    if (window.wp_has_service_consent(category)) return true;\n                    if (isFunction(window.wp_is_service_denied) && window.wp_is_service_denied(category)) return false;\n                } catch (err) {\n                    /* ignore */\n                }\n            }\n\n            if (isFunction(window.wp_has_consent)) {\n                try {\n                    if (window.wp_has_consent(category)) return true;\n                } catch (err2) {\n                    /* ignore */\n                }\n            }\n\n            var consentObj = window.wpConsent || window.WPConsent || null;\n            if (isObject(consentObj) && isFunction(consentObj.get)) {\n                var value = consentObj.get(category);\n                if (value === true || value === false) {\n                    return !!value;\n                }\n            }\n        } catch (err3) {\n            /* ignore */\n        }\n        return null;\n    }\n\n    function detectSlimStatBanner(consentCookieName, category) {\n        try {\n            var value = getCookieStrict(consentCookieName || \"slimstat_gdpr_consent\");\n            if (!value) return null;\n            if (value === \"accepted\") return true;\n            if (value === \"denied\") return false;\n            try {\n                var parsed = JSON.parse(value);\n                if (parsed && parsed[category] !== undefined) {\n                    return !!parsed[category];\n                }\n            } catch (err) {\n                /* ignore */\n            }\n            return value.length > 0;\n        } catch (err4) {\n            return null;\n        }\n    }\n\n    function emitConsentEvent(detail) {\n        if (!detail) {\n            return;\n        }\n        try {\n            var event = new CustomEvent(\"slimstat:consent:updated\", { detail: detail });\n            document.dispatchEvent(event);\n        } catch (err) {\n            try {\n                var fallback = document.createEvent(\"CustomEvent\");\n                fallback.initCustomEvent(\"slimstat:consent:updated\", true, true, detail);\n                document.dispatchEvent(fallback);\n            } catch (compatError) {\n                /* ignore */\n            }\n        }\n    }\n\n    function maybeEmitConsentChange(detail) {\n        if (!detail) {\n            return;\n        }\n        var snapshot = detail.allowed + \"|\" + detail.mode + \"|\" + detail.reason;\n        if (snapshot !== lastConsentSnapshot) {\n            lastConsentSnapshot = snapshot;\n            // Only emit consent event if it's a meaningful change (not just initial check)\n            // This prevents duplicate pageview requests during initial load\n            var params = currentSlimStatParams();\n            var hasPageviewId = params.id && parseInt(params.id, 10) > 0;\n\n            // If we have a pageview ID, emit the event (consent changed after tracking)\n            // If we don't have an ID yet, the initial pageview will handle consent, so skip event\n            if (hasPageviewId) {\n                emitConsentEvent(detail);\n            }\n        }\n    }\n\n    function slimstatConsentAllowed(params, options) {\n        options = options || {};\n        var s = params || {};\n        var anonMode = s.anonymous_tracking === \"on\";\n        var setCookie = s.set_tracker_cookie === \"on\";\n        var anonymizeIP = s.anonymize_ip === \"on\";\n        var hashIP = s.hash_ip === \"on\";\n        var integrationKey = s.consent_integration || \"\";\n        var consentLevel = s.consent_level_integration || \"statistics\";\n\n        try {\n            var dntEnabled = s.respect_dnt === \"on\";\n            if (dntEnabled && typeof navigator !== \"undefined\" && (navigator.doNotTrack === \"1\" || navigator.doNotTrack === \"yes\")) {\n                var blocked = { allowed: false, mode: \"blocked\", reason: \"dnt\" };\n                maybeEmitConsentChange(blocked);\n                return blocked;\n            }\n        } catch (err) {\n            /* ignore */\n        }\n\n        var collectsPII = !!(setCookie || (!anonymizeIP && !hashIP));\n        var requiresCmpCheck = collectsPII || anonMode;\n        var cmpAllows = null;\n\n        if (requiresCmpCheck) {\n            if (integrationKey === \"wp_consent_api\" || integrationKey === \"wpconsent\" || integrationKey === \"wp_consent\" || integrationKey === \"\") {\n                var jsConsent = detectWPConsentAPI(consentLevel);\n                if (jsConsent !== null) {\n                    cmpAllows = jsConsent;\n                }\n                if (cmpAllows === null && s.server_side_consent !== undefined) {\n                    cmpAllows = !!s.server_side_consent;\n                }\n                if (integrationKey === \"\" && cmpAllows === null) {\n                    cmpAllows = true;\n                }\n            }\n\n            if (cmpAllows === null && (integrationKey === \"real_cookie_banner\" || integrationKey === \"rcb\" || integrationKey === \"realcookie\")) {\n                var rcbConsent = detectRealCookieBannerConsent(consentLevel);\n                if (rcbConsent !== null) {\n                    cmpAllows = rcbConsent;\n                }\n                if (cmpAllows === null) {\n                    var fallback = detectWPConsentAPI(consentLevel);\n                    if (fallback !== null) {\n                        cmpAllows = fallback;\n                    }\n                }\n            }\n\n            if (cmpAllows === null && (integrationKey === \"slimstat_banner\" || integrationKey === \"slimstat\")) {\n                var cookieName = s.gdpr_cookie_name || \"slimstat_gdpr_consent\";\n                var bannerConsent = detectSlimStatBanner(cookieName, consentLevel);\n                if (bannerConsent !== null) {\n                    cmpAllows = bannerConsent;\n                }\n            }\n\n            if (cmpAllows === null) {\n                cmpAllows = false;\n            }\n        }\n\n        if (anonMode) {\n            var cmpGranted = cmpAllows === true;\n            var anonDecision = {\n                allowed: true,\n                mode: cmpGranted ? \"full\" : \"anonymous\",\n                reason: cmpGranted ? \"anonymous_mode_consented\" : \"anonymous_mode\",\n            };\n            maybeEmitConsentChange(anonDecision);\n            return anonDecision;\n        }\n\n        if (!collectsPII) {\n            var noPii = { allowed: true, mode: \"full\", reason: \"no_pii\" };\n            maybeEmitConsentChange(noPii);\n            return noPii;\n        }\n\n        if (cmpAllows === false) {\n            var denied = { allowed: false, mode: \"blocked\", reason: \"cmp_denied\" };\n            maybeEmitConsentChange(denied);\n            return denied;\n        }\n\n        var allowedResult = { allowed: true, mode: \"full\", reason: \"cmp_allowed\" };\n        maybeEmitConsentChange(allowedResult);\n        return allowedResult;\n    }\n\n    function buildPageviewBase(params) {\n        if (!isEmpty(params.id) && parseInt(params.id, 10) > 0) return \"action=slimtrack&id=\" + params.id;\n        var base = \"action=slimtrack&ref=\" + base64Encode(document.referrer) + \"&res=\" + base64Encode(window.location.href);\n        if (!isEmpty(params.ci)) base += \"&ci=\" + params.ci;\n        return base;\n    }\n\n    function sendPageview(options) {\n        options = options || {};\n        extractSlimStatParams();\n\n        // Avoid duplicate non-navigation pageviews within the same page load.\n        // Navigation events (SPA transitions) are always allowed to create additional pageviews.\n        // Consent retries are also allowed to override the \"already tracked\" check.\n        try {\n            if (!options.isNavigation && !options.isConsentRetry && window.slimstatPageviewTracked === true) {\n                return;\n            }\n        } catch (guardErr) {\n            /* ignore */\n        }\n\n        // Prevent duplicate requests with stronger locking mechanism\n        var requestKey = \"slimstat_pageview_\" + (options.isNavigation ? \"nav\" : \"init\") + \"_\" + (options.isConsentRetry ? \"retry\" : \"normal\");\n        if (window.sendingSlimStatPageview || window[requestKey]) {\n            return;\n        }\n        window.sendingSlimStatPageview = true;\n        window[requestKey] = true;\n\n        var params = currentSlimStatParams();\n\n        var consentDecision = slimstatConsentAllowed(params, {\n            isNavigation: !!options.isNavigation,\n            isConsentRetry: !!options.isConsentRetry,\n        });\n\n        if (!consentDecision.allowed) {\n            window.sendingSlimStatPageview = false;\n            delete window[requestKey];\n            return;\n        }\n\n        // Check if this is a navigation event (not initial page load)\n        var isNavigationEvent = options.isNavigation || false;\n        var isConsentRetry = options.isConsentRetry || false;\n\n        // For navigation events, always track regardless of javascript_mode\n        // For initial page load, skip if server-side tracking is active\n        if (!isNavigationEvent && !isConsentRetry && !isEmpty(params.id) && parseInt(params.id, 10) > 0) {\n            // Server-side tracking is active for initial page load, skip pageview but allow interactions\n            window.sendingSlimStatPageview = false;\n            delete window[requestKey];\n            return;\n        }\n\n        // For navigation events, we need to track the new page, not the current one\n        if (isNavigationEvent) {\n            // Force a new pageview for the navigation event\n            params.id = null;\n        }\n\n        var payloadBase = buildPageviewBase(params);\n\n        if (!payloadBase) {\n            window.sendingSlimStatPageview = false;\n            delete window[requestKey];\n            return;\n        }\n\n        // Prevent duplicate pageview requests\n        if (pageviewInProgress) {\n            window.sendingSlimStatPageview = false;\n            delete window[requestKey];\n            return;\n        }\n\n        // De-duplicate rapid navigations (e.g., WP Interactivity quick transitions)\n        var now = Date.now();\n        if (payloadBase === lastPageviewPayload && now - lastPageviewSentAt < 150) {\n            window.sendingSlimStatPageview = false;\n            delete window[requestKey];\n            return;\n        }\n        lastPageviewPayload = payloadBase;\n        lastPageviewSentAt = now;\n        var waitForId = isEmpty(params.id) || parseInt(params.id, 10) <= 0; // when new pageview\n        var useBeacon = !waitForId; // need sync response when creating id\n        // Avoid parallel initial pageview duplication\n        if (inflightPageview && waitForId) {\n            window.sendingSlimStatPageview = false;\n            delete window[requestKey];\n            return;\n        }\n        inflightPageview = waitForId;\n        pageviewInProgress = true;\n\n        // Reset finalization state when starting new pageview\n        // Note: finalizationInProgress is now managed in initSlimStatRuntime scope\n\n        // Consolidated flag reset helper to prevent race conditions\n        var resetPageviewFlags = function () {\n            // Single source of truth for flag resets\n            // Delay allows sendToServer queue to process before allowing next pageview\n            setTimeout(function () {\n                inflightPageview = false;\n                pageviewInProgress = false;\n                window.sendingSlimStatPageview = false;\n                delete window[requestKey];\n            }, 200);\n        };\n\n        // Build consent upgrade parameters if this is a consent retry\n        // These are appended to the tracking payload so the backend can\n        // upgrade the existing anonymous pageview to full PII.\n        var consentUpgradeParam = \"\";\n        if (options.consentUpgrade) {\n            consentUpgradeParam = \"&consent_upgrade=1\";\n            if (params.id) {\n                // Send the current pageview ID (with checksum) so the server can\n                // update this specific record, same as in the explicit upgrade AJAX.\n                consentUpgradeParam += \"&pageview_id=\" + encodeURIComponent(params.id);\n            }\n        }\n\n        // Add consent parameters if provided (from banner accept)\n        if (options.consent && (options.consent === \"accepted\" || options.consent === \"denied\")) {\n            consentUpgradeParam += \"&banner_consent=\" + encodeURIComponent(options.consent);\n            if (options.consentNonce) {\n                consentUpgradeParam += \"&banner_consent_nonce=\" + encodeURIComponent(options.consentNonce);\n            }\n        }\n\n        var run = function () {\n            // If anonymous mode is active, skip fingerprinting entirely to ensure no PII is collected/sent\n            if (consentDecision.mode === \"anonymous\") {\n                initFingerprintHash(null);\n                sendToServer(payloadBase + buildSlimStatData({}) + consentUpgradeParam, useBeacon, { immediate: isEmpty(params.id), onComplete: resetPageviewFlags });\n                return;\n            }\n\n            // FingerprintJS v4 async init; if it fails, proceed without fingerprint\n            try {\n                // Safely check if FingerprintJS library is available\n                var fpPromise = null;\n                if (typeof FingerprintJS !== \"undefined\" && FingerprintJS.load) {\n                    fpPromise = FingerprintJS.load();\n                }\n\n                // Only proceed with promise chain if we have a valid promise\n                if (fpPromise && typeof fpPromise.then === \"function\") {\n                    fpPromise\n                        .then(function (result) {\n                            initFingerprintHash(result);\n                            sendToServer(payloadBase + buildSlimStatData(result.components || {}) + consentUpgradeParam, useBeacon, { immediate: isEmpty(params.id), onComplete: resetPageviewFlags });\n                        })\n                        .catch(function () {\n                            initFingerprintHash(null);\n                            sendToServer(payloadBase + buildSlimStatData({}) + consentUpgradeParam, useBeacon, { immediate: isEmpty(params.id), onComplete: resetPageviewFlags });\n                        });\n                } else {\n                    // Library not available; proceed without fingerprint\n                    initFingerprintHash(null);\n                    sendToServer(payloadBase + buildSlimStatData({}) + consentUpgradeParam, useBeacon, { immediate: isEmpty(params.id), onComplete: resetPageviewFlags });\n                }\n            } catch (e) {\n                // Catch synchronous errors (shouldn't happen, but defensive)\n                initFingerprintHash(null);\n                sendToServer(payloadBase + buildSlimStatData({}) + consentUpgradeParam, useBeacon, { immediate: isEmpty(params.id), onComplete: resetPageviewFlags });\n            }\n        };\n        if (window.requestIdleCallback) window.requestIdleCallback(run);\n        else setTimeout(run, 250);\n    }\n\n    // -------------------------- Consent Management -------------------------- //\n    // GDPR consent is now handled by external CMP plugins (Complianz, Cookie Notice, etc.)\n    // SlimStat integrates via WP Consent API or custom integrations\n    // No internal banner or consent UI is provided\n\n    // -------------------------- Offline Data Handling -------------------------- //\n    function storeOffline(payload) {\n        try {\n            var offline = loadOfflineQueue();\n            offline.push({ p: payload, t: Date.now() });\n            saveOfflineQueue(offline);\n        } catch (e) {\n            // Silently fail if localStorage is not available\n        }\n    }\n\n    function flushOfflineQueue() {\n        try {\n            var offline = loadOfflineQueue();\n            if (!offline.length) return;\n\n            var params = currentSlimStatParams();\n            if (!params.id || parseInt(params.id, 10) <= 0) return; // need valid ID to send\n\n            // Send offline items in batches to avoid overwhelming the server\n            var batchSize = 5;\n            var sent = 0;\n            var toRemove = [];\n\n            for (var i = 0; i < offline.length && sent < batchSize; i++) {\n                var item = offline[i];\n                if (item && item.p) {\n                    // Update payload with current ID if it has a placeholder\n                    var payload = item.p;\n                    if (payload.indexOf(\"id=pending\") !== -1) {\n                        payload = payload.replace(\"id=pending\", \"id=\" + params.id);\n                    }\n\n                    if (sendToServer(payload, false, { priority: \"normal\" })) {\n                        toRemove.push(i);\n                        sent++;\n                    }\n                }\n            }\n\n            // Remove sent items from offline queue\n            if (toRemove.length > 0) {\n                for (var j = toRemove.length - 1; j >= 0; j--) {\n                    offline.splice(toRemove[j], 1);\n                }\n                saveOfflineQueue(offline);\n            }\n        } catch (e) {\n            // Silently fail if there are any issues\n        }\n    }\n\n    // -------------------------- Navigation / Interactivity Integration -------------------------- //\n    function setupNavigationHooks() {\n        // WordPress Interactivity API Event\n        addEvent(document, \"wp-interactivity:navigate\", function () {\n            // Finalize current pageview (if any) before starting a new one\n            var params = currentSlimStatParams();\n            if (params.id && parseInt(params.id, 10) > 0) {\n                sendToServer(\"action=slimtrack&id=\" + params.id, true, { priority: \"high\" });\n            }\n            params.id = null; // force new id on next pageview\n            sendPageview();\n        });\n\n        // History API overrides (fallback for SPAs / Interactivity polyfills)\n        if (window.history && history.pushState) {\n            var originalPush = history.pushState;\n            var originalReplace = history.replaceState;\n            history.pushState = function () {\n                var params = currentSlimStatParams();\n                if (params.id) sendToServer(\"action=slimtrack&id=\" + params.id, true, { priority: \"high\" }); // finalize existing\n                params.id = null; // force new id\n                var res = originalPush.apply(this, arguments);\n                sendPageview();\n                return res;\n            };\n            history.replaceState = function () {\n                var res = originalReplace.apply(this, arguments);\n                sendPageview();\n                return res;\n            };\n            addEvent(window, \"popstate\", function () {\n                currentSlimStatParams().id = null;\n                sendPageview();\n            });\n        }\n    }\n\n    // -------------------------- Event Delegation for Clicks -------------------------- //\n    function setupClickDelegation() {\n        addEvent(document.body, \"click\", function (e) {\n            var target = e.target;\n            while (target && target !== document.body) {\n                if (target.matches && target.matches(\"a,button,input,area\")) {\n                    trackInteraction(e, null, null);\n                    break;\n                }\n                target = target.parentNode;\n            }\n        });\n    }\n\n    // -------------------------- Public API (legacy names preserved) -------------------------- //\n    return {\n        // legacy constant (used by base64 algorithm)\n        base64_key_str: BASE64_KEY_STR,\n        // expose fingerprint\n        get fingerprint_hash() {\n            return fingerprintHash;\n        },\n        set fingerprint_hash(v) {\n            fingerprintHash = v;\n        },\n        // legacy wrappers\n        utf8_encode: utf8Encode,\n        base64_encode: base64Encode,\n        get_page_performance: getPagePerformance,\n        get_server_latency: getServerLatency,\n        // Deprecated GDPR UI removed\n        add_event: addEvent,\n        in_array: anySubstring,\n        empty: isEmpty,\n        get_cookie: getCookie,\n        send_to_server: sendToServer,\n        ss_track: trackInteraction,\n        init_fingerprint_hash: initFingerprintHash,\n        get_slimstat_data: buildSlimStatData,\n        get_component_value: getComponentValue,\n        // Offline data handling\n        store_offline: storeOffline,\n        flush_offline_queue: flushOfflineQueue,\n        flush_pending_interactions: flushPendingInteractions,\n        consent: {\n            checkAllowed: slimstatConsentAllowed,\n            emit: emitConsentEvent,\n        },\n        // New internal helpers (not documented previously)\n        _extract_params: extractSlimStatParams,\n        _send_pageview: sendPageview,\n        // Expose functions for the runtime\n        _assign_runtime_helpers: function (helpers) {\n            pendingInteractions = helpers.pendingInteractions;\n            loadOfflineQueue = helpers.loadOfflineQueue;\n            saveOfflineQueue = helpers.saveOfflineQueue;\n            currentSlimStatParams = helpers.currentSlimStatParams;\n            pageviewInProgress = helpers.pageviewInProgress;\n        },\n    };\n})();\n\n// Polyfills for ES5 and older browsers\nif (!Element.prototype.matches) {\n    Element.prototype.matches =\n        Element.prototype.matchesSelector ||\n        Element.prototype.mozMatchesSelector ||\n        Element.prototype.msMatchesSelector ||\n        Element.prototype.oMatchesSelector ||\n        Element.prototype.webkitMatchesSelector ||\n        function (s) {\n            var matches = (this.document || this.ownerDocument).querySelectorAll(s),\n                i = matches.length;\n            // eslint-disable-next-line no-empty\n            while (--i >= 0 && matches.item(i) !== this) {}\n            return i > -1;\n        };\n}\nif (!String.prototype.trim) {\n    String.prototype.trim = function () {\n        return this.replace(/^\\s+|\\s+$/g, \"\");\n    };\n}\nif (!Array.isArray) {\n    Array.isArray = function (arg) {\n        return Object.prototype.toString.call(arg) === \"[object Array]\";\n    };\n}\nif (!window.requestIdleCallback) {\n    window.requestIdleCallback = function (callback) {\n        return setTimeout(callback, 250);\n    };\n}\n\n// Main initialization (refactored)\n(function initSlimStatRuntime() {\n    // Track whether we've already finalized the current pageview (avoid duplicate beacons)\n    var finalized = false;\n\n    // Variables to share with SlimStat IIFE\n    var pendingInteractions = [];\n    var pageviewInProgress = false;\n    var OFFLINE_KEY = \"slimstat_offline_queue\";\n\n    // Helper functions for consent detection (local copies for scope access)\n    function isFunction(value) {\n        return typeof value === \"function\";\n    }\n\n    function isObject(value) {\n        return value !== null && typeof value === \"object\";\n    }\n\n    function getCookieStrict(name) {\n        if (!name) return null;\n        try {\n            var safeName = name.replace(/([.$?*|{}()\\[\\]\\\\\\/\\+^])/g, \"\\\\$1\");\n            var pattern = \"(?:^|;)\\\\s*\" + safeName + \"=([^;]*)\";\n            var match = document.cookie.match(pattern);\n            return match ? decodeURIComponent(match[1]) : null;\n        } catch (e) {\n            return null;\n        }\n    }\n\n    function loadOfflineQueue() {\n        try {\n            var raw = localStorage.getItem(OFFLINE_KEY);\n            if (!raw) return [];\n            var arr = JSON.parse(raw);\n            return Array.isArray(arr) ? arr : [];\n        } catch (e) {\n            return [];\n        }\n    }\n\n    function finalizeCurrent(reason) {\n        if (finalized) return;\n        var p = window.SlimStatParams || {};\n        if (p.id && parseInt(p.id, 10) > 0) {\n            // Attach a tiny hint (reason) so backend could differentiate (ignored if unsupported)\n            var payload = \"action=slimtrack&id=\" + p.id + (reason ? \"&fv=\" + encodeURIComponent(reason) : \"\");\n            SlimStat.send_to_server(payload, true, { priority: \"high\", immediate: false });\n            finalized = true;\n        }\n    }\n\n    function saveOfflineQueue(arr) {\n        try {\n            localStorage.setItem(OFFLINE_KEY, JSON.stringify(arr.slice(-200))); // cap\n        } catch (e) {\n            /* ignore */\n        }\n    }\n\n    function currentSlimStatParams() {\n        // Ensure global object exists\n        if (!window.SlimStatParams) window.SlimStatParams = {};\n        return window.SlimStatParams;\n    }\n\n    // Share these with the SlimStat IIFE\n    SlimStat._assign_runtime_helpers({\n        pendingInteractions: pendingInteractions,\n        loadOfflineQueue: loadOfflineQueue,\n        saveOfflineQueue: saveOfflineQueue,\n        currentSlimStatParams: currentSlimStatParams,\n        pageviewInProgress: pageviewInProgress,\n    });\n\n    // Track whether we've already finalized the current pageview (avoid duplicate beacons)\n    var finalizedPageviews = {};\n    // Track currently in-flight finalization requests to avoid races\n    var inFlightFinalizations = {};\n    // Finalization state management (moved from SlimStat closure to avoid scope issues)\n    var finalizationInProgress = false;\n    var lastFinalizationReason = \"\";\n    var lastFinalizationTime = 0;\n    var FINALIZATION_COOLDOWN = 1000; // 1 second cooldown between finalizations\n    // Global interaction flag used to avoid sending a duplicate pageview when the user leaves\n    try {\n        if (typeof window.__slimstatHasInteraction === \"undefined\") window.__slimstatHasInteraction = false;\n    } catch (e) {\n        /* ignore */\n    }\n    // Global flag to prevent concurrent pageview sends\n    try {\n        if (typeof window.sendingSlimStatPageview === \"undefined\") window.sendingSlimStatPageview = false;\n        if (typeof window.slimstatPageviewTracked === \"undefined\") window.slimstatPageviewTracked = false;\n    } catch (e) {\n        /* ignore */\n    }\n\n    function finalizeCurrent(reason) {\n        var p = currentSlimStatParams();\n        if (!p.id || parseInt(p.id, 10) <= 0 || finalizedPageviews[p.id] || inFlightFinalizations[p.id]) return; // no pageview id yet or already finalized/in-flight\n\n        var now = Date.now();\n        if (finalizationInProgress || (reason === lastFinalizationReason && now - lastFinalizationTime < FINALIZATION_COOLDOWN)) return;\n\n        finalizationInProgress = true;\n        lastFinalizationReason = reason;\n        lastFinalizationTime = now;\n\n        // Mark in-flight to prevent concurrent senders (race protection)\n        inFlightFinalizations[p.id] = true;\n\n        // Old behavior: send a simple finalize to let the server compute dt_out\n        var payload = \"action=slimtrack&id=\" + p.id + (reason ? \"&fv=\" + encodeURIComponent(reason) : \"\");\n        SlimStat.send_to_server(payload, true, { priority: \"high\", immediate: false });\n\n        // Mark finalized and clear in-flight after a short window\n        finalizedPageviews[p.id] = true;\n        setTimeout(function () {\n            delete inFlightFinalizations[p.id];\n            finalizationInProgress = false;\n        }, 120);\n    }\n\n    // Observe for parameter mutations (meta tag or script changes)\n    // Only observe if we don't have an ID yet (to avoid unnecessary tracking requests)\n    var lastParams = JSON.stringify(currentSlimStatParams());\n    var observer = new MutationObserver(function () {\n        var params = currentSlimStatParams();\n        // Only extract params if we don't have an ID yet (initial page load)\n        if (SlimStat.empty(params.id) || parseInt(params.id, 10) <= 0) {\n            SlimStat._extract_params();\n            var serialized = JSON.stringify(currentSlimStatParams());\n            if (serialized !== lastParams) lastParams = serialized; // reserved for future diff-based logic\n        }\n    });\n    observer.observe(document.head, { childList: true, subtree: true });\n    observer.observe(document.body, { childList: true, subtree: true });\n\n    // Initial pageview\n    SlimStat.add_event(window, \"load\", function () {\n        SlimStat._extract_params();\n\n        // Proceed with normal tracking; consent is gated by CMP checks in sendPageview()\n        SlimStat._send_pageview();\n\n        // Flush any offline stored payloads after initial pageview queued\n        setTimeout(function () {\n            try {\n                if (navigator.onLine !== false) SlimStat.flush_offline_queue();\n            } catch (e) {}\n        }, 500);\n    });\n\n    // Listen for WP Consent API consent changes and retry pageview if previously blocked\n    document.addEventListener(\"wp_listen_for_consent_change\", function (event) {\n        try {\n            var detail = (event && event.detail) || {};\n            var params = currentSlimStatParams();\n            var selectedCategory = params.consent_level_integration || \"statistics\";\n            var retryKey = \"slimstatConsentRetried_\" + selectedCategory;\n\n            if (detail[selectedCategory] && detail[selectedCategory] === \"allow\" && (!window[retryKey] || window[retryKey] === false)) {\n                window[retryKey] = true;\n                SlimStat._send_pageview();\n            }\n        } catch (e) {\n            /* ignore */\n        }\n    });\n\n    // Backwards compatibility: some integrations expose a helper on window\n    if (typeof window.wp_listen_for_consent_change === \"function\") {\n        try {\n            window.wp_listen_for_consent_change(function (category) {\n                var params = currentSlimStatParams();\n                var selectedCategory = params.consent_level_integration || \"statistics\";\n                var retryKey = \"slimstatConsentRetried_\" + selectedCategory;\n\n                if (category === selectedCategory && (!window[retryKey] || window[retryKey] === false)) {\n                    window[retryKey] = true;\n                    SlimStat._send_pageview();\n                }\n            });\n        } catch (e) {\n            /* ignore */\n        }\n    }\n\n    // Listen for consent type definitions to catch late initializations\n    document.addEventListener(\"wp_consent_type_defined\", function () {\n        try {\n            var params = currentSlimStatParams();\n            var selectedCategory = params.consent_level_integration || \"statistics\";\n            var retryKey = \"slimstatConsentRetried_\" + selectedCategory;\n\n            if (!window[retryKey]) {\n                if (typeof window.wp_has_consent === \"function\") {\n                    if (window.wp_has_consent(selectedCategory)) {\n                        window[retryKey] = true;\n                        SlimStat._send_pageview();\n                    }\n                } else {\n                    window[retryKey] = true;\n                    SlimStat._send_pageview();\n                }\n            }\n        } catch (e) {\n            /* ignore */\n        }\n    });\n\n    // Standard WP Consent API event listener\n    document.addEventListener(\"wp_consent_change\", function (event) {\n        if (event.detail && event.detail.category) {\n            var category = event.detail.category;\n            var params = currentSlimStatParams();\n            var selectedCategory = params.consent_level_integration || \"statistics\";\n\n            // Use category-specific retry flag to prevent race conditions between CMPs\n            var retryKey = \"slimstatConsentRetried_\" + selectedCategory;\n            var consentRetried = window[retryKey] || false;\n\n            var shouldTrack = !consentRetried && category === selectedCategory && (!params.id || parseInt(params.id, 10) <= 0);\n\n            if (shouldTrack) {\n                // Double-check with WP Consent API if available\n                if (typeof window.wp_has_consent === \"function\" && !window.wp_has_consent(selectedCategory)) return;\n                window[retryKey] = true;\n                SlimStat._send_pageview();\n            }\n        }\n    });\n\n    // CMP-specific listeners\n    // Define tryTrackIfAllowed in outer scope so handleConsentGranted can access it\n    function tryTrackIfAllowed() {\n        var params = currentSlimStatParams();\n        var selectedCategory = params.consent_level_integration || \"statistics\";\n        if (params.id && parseInt(params.id, 10) > 0) {\n            return;\n        }\n        if (typeof window.wp_has_consent === \"function\" && !window.wp_has_consent(selectedCategory)) {\n            return;\n        }\n\n        // Use category-specific retry flag to prevent race conditions between CMPs\n        var retryKey = \"slimstatConsentRetried_\" + selectedCategory;\n        // Check if we've already successfully sent a request (not just attempted)\n        var retryTimestampKey = retryKey + \"_timestamp\";\n        var lastRetryTime = window[retryTimestampKey] || 0;\n        var timeSinceLastRetry = Date.now() - lastRetryTime;\n\n        // Check if a pageview is already being sent (prevent duplicate from multiple event sources)\n        if (window.sendingSlimStatPageview) {\n            return;\n        }\n\n        // Allow retry if:\n        // 1. Never tried before, OR\n        // 2. Last attempt was more than 2 seconds ago (enough time for request to complete)\n        if (!window[retryKey] || (window[retryKey] && timeSinceLastRetry > 2000)) {\n            // Check if lock is active - if so, delay and retry\n            var requestKey = \"slimstat_pageview_init_retry\";\n            if (window.sendingSlimStatPageview || window[requestKey]) {\n                setTimeout(function () {\n                    tryTrackIfAllowed();\n                }, 500);\n                return;\n            }\n            // Mark that we're attempting to send (but don't set permanent flag yet)\n            window[retryKey] = true;\n            window[retryTimestampKey] = Date.now();\n            // Use isConsentRetry flag to prevent duplicate detection\n            // Add consent_upgrade parameter to signal backend to upgrade existing anonymous pageview\n            SlimStat._send_pageview({ isConsentRetry: true, consentUpgrade: true });\n\n            // After a delay, check if request was actually sent\n            // If lock is still active after 1 second, it means request was blocked\n            setTimeout(function () {\n                var requestKeyCheck = \"slimstat_pageview_init_retry\";\n                // If lock is still active, it means request was blocked, so reset flag\n                // But only if enough time has passed (request should complete in < 1 second)\n                if (window.sendingSlimStatPageview || window[requestKeyCheck]) {\n                    // Lock still active after 1 second - request was likely blocked\n                    // Reset flag to allow retry\n                    window[retryKey] = false;\n                }\n            }, 1000);\n        }\n    }\n\n    // CMP-specific listeners\n    (function registerCmpListeners() {\n        // Complianz: enable specific category\n        document.addEventListener(\"cmplz_enable_category\", function (e) {\n            var params = currentSlimStatParams();\n            var selectedCategory = params.consent_level_integration || \"statistics\";\n            var cat = (e && e.detail && (e.detail.category || e.detail)) || \"\";\n            if (cat === selectedCategory) tryTrackIfAllowed();\n        });\n\n        // Complianz: status event (allow/deny)\n        document.addEventListener(\"cmplz_event_status\", function (e) {\n            var params = currentSlimStatParams();\n            var selectedCategory = params.consent_level_integration || \"statistics\";\n            var d = (e && e.detail) || {};\n            var cat = d.category || d.type || \"\";\n            var allowed = d.status === \"allow\" || d.enabled === true;\n            if (cat === selectedCategory && allowed) tryTrackIfAllowed();\n        });\n\n        // Real Cookie Banner - multiple event names for compatibility\n        var rcbHandlerDebounceTimer = null;\n        var rcbHandlerLastCall = 0;\n        function handleRCBConsentChange(e) {\n            var now = Date.now();\n            var params = currentSlimStatParams();\n            var integrationKey = params.consent_integration || \"\";\n\n            if (integrationKey !== \"real_cookie_banner\" && integrationKey !== \"rcb\" && integrationKey !== \"realcookie\") {\n                return;\n            }\n\n            var selectedCategory = params.consent_level_integration || \"statistics\";\n            var ok = false;\n\n            if (e && e.detail) {\n                if (e.detail.consent && selectedCategory in e.detail.consent) {\n                    var categoryConsent = e.detail.consent[selectedCategory];\n                    if (typeof categoryConsent === \"boolean\") {\n                        ok = categoryConsent;\n                    } else if (categoryConsent && categoryConsent.cookie !== null) {\n                        ok = true;\n                    }\n                } else if (e.detail.button && (e.detail.button === \"accept_all\" || e.detail.button === \"accept_essentials\" || e.detail.button === \"save\")) {\n                    var consentCheck = SlimStat.consent.checkAllowed(params, {});\n                    ok = consentCheck && consentCheck.allowed && consentCheck.mode === \"full\";\n                }\n            }\n\n            if (!ok && typeof window.wp_has_consent === \"function\") {\n                ok = !!window.wp_has_consent(selectedCategory);\n            }\n\n            if (!ok) {\n                var consentCheck = SlimStat.consent.checkAllowed(params, {});\n                ok = consentCheck && consentCheck.allowed && consentCheck.mode === \"full\";\n            }\n\n            if (ok) {\n                clearTimeout(rcbHandlerDebounceTimer);\n                var timeSinceLastCall = now - rcbHandlerLastCall;\n                var debounceDelay = timeSinceLastCall < 100 ? 100 - timeSinceLastCall : 0;\n                rcbHandlerDebounceTimer = setTimeout(function () {\n                    // Don't call handleConsentGranted here - RCB events will trigger it directly\n                    // Just call tryTrackIfAllowed if no pageview ID exists yet\n                    var params = currentSlimStatParams();\n                    if (!params.id || parseInt(params.id, 10) <= 0) {\n                        tryTrackIfAllowed();\n                    }\n                }, debounceDelay);\n                rcbHandlerLastCall = now;\n            }\n        }\n\n        // Listen for all RCB event variations\n        document.addEventListener(\"RealCookieBannerConsentChanged\", handleRCBConsentChange);\n        document.addEventListener(\"rcb-consent-changed\", handleRCBConsentChange);\n        document.addEventListener(\"rcb-consent-update\", handleRCBConsentChange);\n        document.addEventListener(\"rcb-consent-saved\", handleRCBConsentChange);\n\n        // CookieYes (cookie-law-info) events\n        // Fire after a short delay to allow WP Consent API state to update\n        document.addEventListener(\"cookieyes_consent_update\", function () {\n            setTimeout(tryTrackIfAllowed, 50);\n        });\n        document.addEventListener(\"cookieyes_preferences_update\", function () {\n            setTimeout(tryTrackIfAllowed, 50);\n        });\n        // Older CookieYes/CLI plugins\n        document.addEventListener(\"cli_consent_update\", function () {\n            setTimeout(tryTrackIfAllowed, 50);\n        });\n    })();\n\n    // Before unload finalize if we have an active id\n    // Use multiple lifecycle signals to improve reliability across SPA / tab discard / mobile browsers\n    SlimStat.add_event(document, \"visibilitychange\", function () {\n        // Only finalize if we have an active ID and the page is actually hidden\n        var params = currentSlimStatParams();\n        if (document.visibilityState === \"hidden\" && params.id && parseInt(params.id, 10) > 0) {\n            debouncedFinalize(\"visibility\");\n        }\n    });\n    SlimStat.add_event(window, \"pagehide\", function () {\n        // Only finalize if we have an active ID\n        var params = currentSlimStatParams();\n        if (params.id && parseInt(params.id, 10) > 0) {\n            debouncedFinalize(\"pagehide\");\n        }\n    });\n    SlimStat.add_event(window, \"beforeunload\", function () {\n        // Only finalize if we have an active ID\n        var params = currentSlimStatParams();\n        if (params.id && parseInt(params.id, 10) > 0) {\n            debouncedFinalize(\"beforeunload\");\n        }\n    });\n\n    // Add a small delay between finalization attempts to prevent rapid-fire duplicates\n    var finalizationTimeout = null;\n    function debouncedFinalize(reason) {\n        // Don't finalize if already finalized for this pageview ID\n        var p = currentSlimStatParams();\n        if (!p.id || finalizedPageviews[p.id]) return;\n\n        if (finalizationTimeout) {\n            clearTimeout(finalizationTimeout);\n        }\n        finalizationTimeout = setTimeout(function () {\n            finalizeCurrent(reason);\n        }, 50);\n    }\n\n    // Online event to resend offline queue\n    SlimStat.add_event(window, \"online\", function () {\n        SlimStat.flush_offline_queue();\n        SlimStat.flush_pending_interactions();\n    });\n\n    // Before unload, persist any pending interactions that don't have an ID yet\n    SlimStat.add_event(window, \"beforeunload\", function () {\n        var params = currentSlimStatParams();\n        if ((!params.id || parseInt(params.id, 10) <= 0) && pendingInteractions.length > 0) {\n            // No ID assigned, so we can't send these. Store them offline.\n            // We assume they are for the most recent pageview attempt.\n            var offline = loadOfflineQueue();\n            pendingInteractions.forEach(function (raw) {\n                // To send these later, we need to stub a payload.\n                // We'll add a placeholder that the server-side can reconcile.\n                var placeholderPayload = \"action=slimtrack&id=pending\" + raw;\n                offline.push({ p: placeholderPayload, t: Date.now() });\n            });\n            saveOfflineQueue(offline);\n            pendingInteractions.length = 0; // Clear buffer\n        }\n    });\n\n    function setupClickDelegation() {\n        SlimStat.add_event(document.body, \"click\", function (e) {\n            var target = e.target;\n            while (target && target !== document.body) {\n                // Skip GDPR consent buttons to avoid duplicate processing\n                if (target.hasAttribute && target.hasAttribute(\"data-consent\")) {\n                    break;\n                }\n                if (target.matches && target.matches(\"a,button,input,area\")) {\n                    SlimStat.ss_track(e, null, null);\n                    break;\n                }\n                target = target.parentNode;\n            }\n        });\n\n        // No GDPR consent buttons; managed by CMPs\n    }\n\n    function setupNavigationHooks() {\n        // WordPress Interactivity API Event\n        SlimStat.add_event(document, \"wp-interactivity:navigate\", function () {\n            // Prevent duplicate navigation events\n            if (pageviewInProgress) {\n                return;\n            }\n\n            // Capture current URL; only act if it actually changes\n            var oldPathname = window.location.pathname;\n            var oldSearch = window.location.search;\n\n            // Defer the new pageview call to allow the DOM and URL to update\n            setTimeout(function () {\n                var newPathname = window.location.pathname;\n                var newSearch = window.location.search;\n                if (newPathname !== oldPathname || newSearch !== oldSearch) {\n                    var params = currentSlimStatParams();\n                    if (params.id && parseInt(params.id, 10) > 0) {\n                        debouncedFinalize(\"navigation\");\n                    }\n                    SlimStat._send_pageview({ isNavigation: true });\n                }\n            }, 150);\n        });\n\n        // History API overrides (fallback for SPAs / Interactivity polyfills)\n        if (window.history && history.pushState) {\n            var originalPush = history.pushState;\n            var originalReplace = history.replaceState;\n\n            var stateChangeHandler = function (isReplace) {\n                var oldPathname = window.location.pathname;\n                var oldSearch = window.location.search;\n\n                // Apply original function\n                var originalFunc = isReplace ? originalReplace : originalPush;\n                var originalArgs = Array.prototype.slice.call(arguments, 1);\n                var res = originalFunc.apply(this, originalArgs);\n\n                // After a short delay, check if navigation occurred\n                setTimeout(function () {\n                    var newPathname = window.location.pathname;\n                    var newSearch = window.location.search;\n\n                    // A navigation is a change in pathname or a significant change in search params\n                    if (newPathname !== oldPathname || newSearch !== oldSearch) {\n                        var params = currentSlimStatParams();\n                        if (params.id && parseInt(params.id, 10) > 0) {\n                            debouncedFinalize(\"history\");\n                        }\n                        SlimStat._send_pageview({ isNavigation: true });\n                    }\n                }, 150);\n\n                return res;\n            };\n\n            history.pushState = function () {\n                var args = Array.prototype.slice.call(arguments);\n                args.unshift(false);\n                return stateChangeHandler.apply(this, args);\n            };\n\n            history.replaceState = function () {\n                var args = Array.prototype.slice.call(arguments);\n                args.unshift(true);\n                return stateChangeHandler.apply(this, args);\n            };\n\n            SlimStat.add_event(window, \"popstate\", function () {\n                // Prevent duplicate popstate events\n                if (pageviewInProgress) {\n                    return;\n                }\n\n                // Defer to allow URL to update\n                setTimeout(function () {\n                    // Always track navigation events for SPA behavior\n                    // This ensures navigation is tracked even when server-side tracking is active\n                    currentSlimStatParams().id = null;\n                    SlimStat._send_pageview({ isNavigation: true });\n                }, 150);\n            });\n        }\n    }\n\n    // Setup interaction tracking\n    setupClickDelegation();\n    setupNavigationHooks();\n\n    /**\n     * Setup Consent Upgrade Handler\n     *\n     * Listens for consent events from various CMPs (Consent Management Platforms)\n     * and upgrades anonymous tracking to full PII tracking when consent is granted.\n     *\n     * Flow:\n     * 1. User visits site \u2192 Anonymous tracking (hashed IP, no cookies)\n     * 2. User grants consent \u2192 Consent event fired\n     * 3. AJAX request sent to upgrade existing pageview record\n     * 4. IP hash replaced with real IP, tracking cookie set\n     */\n    function setupConsentUpgradeHandler() {\n        var consentUpgradeSent = {};\n        var consentUpgradeRetryCount = 0;\n        var initialConsentState = false;\n        var consentStateInitialized = false;\n        var rcbUpgradePollingDone = false;\n\n        // Helper function to detect Real Cookie Banner consent (local copy for scope access)\n        function detectRCBConsentLocal(category) {\n            try {\n                if (isFunction(window.rcb)) {\n                    try {\n                        var rcbConsent = window.rcb(\"consent\", category);\n                        if (rcbConsent === true || rcbConsent === false) return !!rcbConsent;\n                        if (isObject(rcbConsent) && \"cookie\" in rcbConsent) return !!rcbConsent.cookie;\n                        if (isObject(rcbConsent) && \"consent\" in rcbConsent) return !!rcbConsent.consent;\n                    } catch (e) {\n                        /* ignore */\n                    }\n                }\n\n                if (isObject(window.RCB) && isObject(window.RCB.consent) && isFunction(window.RCB.consent.get)) {\n                    var rcbNew = window.RCB.consent.get(category);\n                    if (rcbNew === true || rcbNew === false) return !!rcbNew;\n                    if (isObject(rcbNew) && \"cookie\" in rcbNew) return !!rcbNew.cookie;\n                    if (isObject(rcbNew) && \"consent\" in rcbNew) return !!rcbNew.consent;\n                }\n\n                if (isObject(window.rcbConsentManager) && isFunction(window.rcbConsentManager.getUserDecision)) {\n                    var decision = window.rcbConsentManager.getUserDecision();\n                    if (decision && decision.decision) {\n                        if (decision.decision === \"all\") return true;\n                        if (typeof decision.decision === \"object\") {\n                            var value = decision.decision[category];\n                            if (typeof value === \"boolean\") return value;\n                            if (Array.isArray(value)) return value.length > 0;\n                        }\n                    }\n                }\n\n                var rcb = window.realCookieBanner || window.RealCookieBanner || null;\n                if (isObject(rcb) && isObject(rcb.consent) && isFunction(rcb.consent.get)) {\n                    var consent = rcb.consent.get(category);\n                    if (consent === true || consent === false) return !!consent;\n                    if (isObject(consent) && \"cookie\" in consent) return !!consent.cookie;\n                    if (consent) return true;\n                }\n\n                var legacy = window.__rcb || window.__RCB || null;\n                if (isObject(legacy) && legacy.consent) {\n                    var legacyVal = legacy.consent[category];\n                    if (typeof legacyVal === \"boolean\") return legacyVal;\n                    if (Array.isArray(legacyVal)) return legacyVal.length > 0;\n                }\n\n                var possibleNames = [\"real_cookie_banner\", \"rcb_consent\", \"rcb_acceptance\", \"real_cookie_consent\", \"rcb-consent\"];\n                for (var i = 0; i < possibleNames.length; i++) {\n                    var raw = getCookieStrict(possibleNames[i]);\n                    if (!raw) {\n                        continue;\n                    }\n                    try {\n                        var parsed = JSON.parse(raw);\n                        if (parsed) {\n                            if (typeof parsed[category] === \"boolean\") return parsed[category];\n                            if (typeof parsed.consent === \"boolean\") return parsed.consent;\n                            if (typeof parsed[category] === \"object\" && parsed[category].cookie !== undefined) return !!parsed[category].cookie;\n                        }\n                    } catch (err) {\n                        var normalized = raw.toLowerCase();\n                        if (raw.indexOf(category) !== -1 || raw === \"1\" || normalized === \"true\" || normalized === \"all\" || normalized === \"accepted\") {\n                            return true;\n                        }\n                    }\n                }\n            } catch (error) {\n                /* ignore */\n            }\n            return null;\n        }\n\n        function initConsentBaseline() {\n            if (consentStateInitialized) {\n                return;\n            }\n            consentStateInitialized = true;\n            try {\n                var params = currentSlimStatParams();\n                var selectedCategory = params.consent_level_integration || \"statistics\";\n                var integrationKey = params.consent_integration || \"\";\n                if (\"real_cookie_banner\" === integrationKey || integrationKey === \"rcb\" || integrationKey === \"realcookie\") {\n                    var rcbConsent = detectRCBConsentLocal(selectedCategory);\n                    if (rcbConsent === null || rcbConsent === false) {\n                        if (typeof window.wp_has_consent === \"function\") {\n                            initialConsentState = !!window.wp_has_consent(selectedCategory);\n                        } else {\n                            initialConsentState = false;\n                        }\n                    } else {\n                        initialConsentState = !!rcbConsent;\n                    }\n                }\n            } catch (e) {\n                /* ignore */\n            }\n        }\n\n        // Consent upgrade AJAX handler and event listeners\n\n        // Prevent simultaneous consent upgrade requests\n        var consentUpgradeInProgress = false;\n\n        function handleConsentGranted(event = false) {\n            // Avoid duplicate/in-progress runs\n            if (consentUpgradeInProgress) return;\n            consentUpgradeInProgress = true;\n\n            try {\n                var params = currentSlimStatParams();\n                var pageviewIdWithChecksum = params.id || \"\";\n                var pageviewIdNumeric = pageviewIdWithChecksum ? parseInt(pageviewIdWithChecksum.toString().split(\".\")[0], 10) : 0;\n\n                // If no pageview tracked, retry a few times, else trigger tracking with consent\n                if (pageviewIdNumeric <= 0 || !pageviewIdWithChecksum) {\n                    if (consentUpgradeRetryCount >= 5) {\n                        consentUpgradeRetryCount = 0;\n                        consentUpgradeInProgress = false;\n                        setTimeout(function () {\n                            tryTrackIfAllowed();\n                        }, 600);\n                        return;\n                    }\n                    consentUpgradeRetryCount++;\n                    setTimeout(function () {\n                        try {\n                            handleConsentGranted();\n                        } catch (err) {}\n                    }, 250);\n                    consentUpgradeInProgress = false;\n                    return;\n                }\n\n                // Prevent double-upgrade for the same pageview\n                if (consentUpgradeSent[pageviewIdWithChecksum]) {\n                    consentUpgradeInProgress = false;\n                    return;\n                }\n\n                // Check actual consent before request\n                var integrationKey = params.consent_integration || \"\";\n                if (integrationKey === \"wp_consent_api\") {\n                    var cat = params.consent_level_integration || \"statistics\";\n                    if (typeof window.wp_has_consent === \"function\" && !window.wp_has_consent(cat)) {\n                        consentUpgradeInProgress = false;\n                        return;\n                    }\n                } else if (integrationKey === \"real_cookie_banner\" || integrationKey === \"rcb\" || integrationKey === \"realcookie\") {\n                    if (!consentStateInitialized) initConsentBaseline();\n                    var cat = params.consent_level_integration || \"statistics\";\n                    var rcbConsent = detectRCBConsentLocal(cat);\n                    if (!rcbConsent && typeof window.wp_has_consent === \"function\") {\n                        rcbConsent = window.wp_has_consent(cat);\n                    }\n                    if (!rcbConsent) {\n                        consentUpgradeInProgress = false;\n                        return;\n                    }\n                }\n\n                consentUpgradeSent[pageviewIdWithChecksum] = true;\n\n                // Do upgrade request\n                var xhr = new XMLHttpRequest();\n                var ajaxUrl = params.ajaxurl || \"/wp-admin/admin-ajax.php\";\n                xhr.open(\"POST\", ajaxUrl, true);\n                xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\n                xhr.onload = function () {\n                    consentUpgradeInProgress = false;\n                    if (xhr.status === 200) {\n                        try {\n                            JSON.parse(xhr.responseText);\n                        } catch (e) {}\n                    }\n                };\n                xhr.onerror = function () {\n                    consentUpgradeInProgress = false;\n                    consentUpgradeSent[pageviewIdWithChecksum] = false; // allow retry\n                };\n\n                // Optionally include fingerprint hash\n                var fingerprintParam = \"\";\n                if (fingerprintHash) {\n                    fingerprintParam = \"&fingerprint=\" + encodeURIComponent(fingerprintHash);\n                }\n\n                var requestData = \"action=slimstat_consent_granted\" + \"&pageview_id=\" + encodeURIComponent(pageviewIdWithChecksum) + \"&nonce=\" + encodeURIComponent(params.wp_rest_nonce || \"\") + fingerprintParam;\n                xhr.send(requestData);\n            } catch (e) {\n                consentUpgradeInProgress = false;\n                // Allow re-send if exception\n                var params = currentSlimStatParams();\n                var pageviewIdWithChecksum = params.id || \"\";\n                if (pageviewIdWithChecksum) consentUpgradeSent[pageviewIdWithChecksum] = false;\n            }\n        }\n\n        SlimStat.handleConsentGranted = handleConsentGranted;\n\n        // Add handlers for main consent provider events\n        document.addEventListener(\"RCB/OptIn\", handleConsentGranted);\n        document.addEventListener(\"RCB/OptIn/All\", handleConsentGranted);\n        document.addEventListener(\"cookieyes_consent_update\", handleConsentGranted);\n        document.addEventListener(\"cookieyes_preferences_update\", handleConsentGranted);\n        document.addEventListener(\"cli_consent_update\", handleConsentGranted);\n        document.addEventListener(\"wp_listen_load\", handleConsentGranted);\n        document.addEventListener(\"wp_consent_type_functional\", handleConsentGranted);\n        document.addEventListener(\"wp_consent_type_statistics\", handleConsentGranted);\n        document.addEventListener(\"slimstat_banner_consent\", handleConsentGranted);\n\n        // Debounced handler for slimstat's own events\n        var consentEventHandled = false;\n        var lastConsentEventTime = 0;\n        document.addEventListener(\"slimstat:consent:updated\", function (event) {\n            if (consentEventHandled) return;\n            if (event && event.detail && event.detail.allowed && event.detail.mode === \"full\") {\n                var now = Date.now();\n                if (now - lastConsentEventTime < 500) return;\n                lastConsentEventTime = now;\n\n                // Only if pageview ID already exists\n                var params = currentSlimStatParams();\n                if (!params.id || parseInt(params.id, 10) <= 0) return;\n\n                consentEventHandled = true;\n                setTimeout(function () {\n                    handleConsentGranted();\n                    consentEventHandled = false;\n                }, 100);\n            }\n        });\n\n        function hasRCBConsent(category) {\n            var consent = detectRealCookieBannerConsent(category);\n            return consent === true || consent === null ? false : !!consent;\n        }\n\n        initConsentBaseline();\n\n        if (typeof window.addEventListener !== \"undefined\") {\n            if (document.readyState === \"loading\") {\n                document.addEventListener(\"DOMContentLoaded\", initConsentBaseline);\n            } else {\n                setTimeout(initConsentBaseline, 0);\n            }\n        }\n    }\n\n    function initSlimStatBanner() {\n        var bannerInitialized = false;\n\n        function attachBannerHandlers() {\n            if (bannerInitialized) {\n                return;\n            }\n\n            var params = currentSlimStatParams();\n            if (!params || params.use_slimstat_banner !== \"on\") {\n                return;\n            }\n\n            var banner = document.getElementById(\"slimstat-gdpr-banner\");\n            if (!banner) {\n                return;\n            }\n\n            bannerInitialized = true;\n\n            setTimeout(function () {\n                if (banner && banner.classList) {\n                    banner.classList.add(\"show\");\n                } else if (banner) {\n                    banner.style.display = \"block\";\n                }\n            }, 50);\n\n            var buttons = banner.querySelectorAll(\"[data-consent]\");\n            for (var i = 0; i < buttons.length; i++) {\n                (function (button) {\n                    if (button.addEventListener) {\n                        button.addEventListener(\n                            \"click\",\n                            function (event) {\n                                if (event && typeof event.preventDefault === \"function\") {\n                                    event.preventDefault();\n                                }\n                                if (event && typeof event.stopPropagation === \"function\") {\n                                    event.stopPropagation();\n                                }\n                                var consent = button.getAttribute(\"data-consent\") || \"\";\n                                submitBannerDecision(consent, banner);\n                            },\n                            false\n                        );\n                    } else if (button.attachEvent) {\n                        button.attachEvent(\"onclick\", function (event) {\n                            if (event && typeof event.preventDefault === \"function\") {\n                                event.preventDefault();\n                            }\n                            if (event && typeof event.stopPropagation === \"function\") {\n                                event.stopPropagation();\n                            }\n                            var consent = button.getAttribute(\"data-consent\") || \"\";\n                            submitBannerDecision(consent, banner);\n                        });\n                    } else {\n                        button.onclick = function (event) {\n                            if (event && typeof event.preventDefault === \"function\") {\n                                event.preventDefault();\n                            }\n                            if (event && typeof event.stopPropagation === \"function\") {\n                                event.stopPropagation();\n                            }\n                            var consent = button.getAttribute(\"data-consent\") || \"\";\n                            submitBannerDecision(consent, banner);\n                        };\n                    }\n                })(buttons[i]);\n            }\n        }\n\n        function submitBannerDecision(consent, bannerEl) {\n            if (!consent || (consent !== \"accepted\" && consent !== \"denied\")) {\n                return;\n            }\n\n            var params = currentSlimStatParams();\n            var nonce = params.wp_rest_nonce || \"\";\n            var cookieName = params.gdpr_cookie_name || \"slimstat_gdpr_consent\";\n            var cookiePath = params.baseurl || \"/\";\n\n            // Set cookie immediately\n            try {\n                var expiry = new Date();\n                expiry.setTime(expiry.getTime() + 365 * 24 * 60 * 60 * 1000);\n                var cookie = cookieName + \"=\" + consent + \"; path=\" + cookiePath + \"; expires=\" + expiry.toUTCString() + \"; SameSite=Lax\";\n                if (window && window.location && window.location.protocol === \"https:\") {\n                    cookie += \"; Secure\";\n                }\n                document.cookie = cookie;\n            } catch (cookieError) {\n                /* ignore cookie errors */\n            }\n\n            // Close banner with animation (before request)\n            if (bannerEl && bannerEl.classList) {\n                bannerEl.classList.remove(\"show\");\n                bannerEl.classList.add(\"hiding\");\n            } else if (bannerEl) {\n                // Fallback for browsers without classList\n                bannerEl.style.transition = \"transform 0.3s ease-out, opacity 0.3s ease-out\";\n                bannerEl.style.transform = \"translateY(100%)\";\n                bannerEl.style.opacity = \"0\";\n            }\n\n            // Remove banner from DOM after animation completes\n            setTimeout(function () {\n                if (bannerEl && bannerEl.parentNode) {\n                    bannerEl.parentNode.removeChild(bannerEl);\n                }\n            }, 350);\n\n            // Dispatch consent event immediately\n            if (consent === \"accepted\") {\n                try {\n                    if (typeof CustomEvent === \"function\") {\n                        document.dispatchEvent(new CustomEvent(\"slimstat_banner_consent\", { detail: { consent: consent } }));\n                    } else {\n                        var evt = document.createEvent(\"Event\");\n                        evt.initEvent(\"slimstat_banner_consent\", true, true);\n                        document.dispatchEvent(evt);\n                    }\n                } catch (dispatchError) {\n                    /* ignore */\n                }\n\n                try {\n                    SlimStat._send_pageview({ isConsentRetry: true, consentUpgrade: true, consent: consent, consentNonce: nonce });\n                } catch (sendError) {\n                    /* ignore */\n                }\n            } else if (consent === \"denied\") {\n                // Call revocation handler to delete tracking cookie\n                try {\n                    var ajaxUrl = params.ajaxurl || \"/wp-admin/admin-ajax.php\";\n                    var revokeXhr = new XMLHttpRequest();\n                    revokeXhr.open(\"POST\", ajaxUrl, true);\n                    revokeXhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n                    revokeXhr.send(\"action=slimstat_consent_revoked&nonce=\" + encodeURIComponent(nonce));\n                    revokeXhr.onload = function () {};\n                    revokeXhr.onerror = function () {};\n                } catch (revokeError) {\n                    /* ignore */\n                }\n            }\n        }\n\n        if (document.readyState && document.readyState !== \"loading\") {\n            attachBannerHandlers();\n        }\n\n        if (document.addEventListener) {\n            document.addEventListener(\"DOMContentLoaded\", attachBannerHandlers, false);\n            window.addEventListener(\"load\", attachBannerHandlers, false);\n        } else if (document.attachEvent) {\n            document.attachEvent(\"onreadystatechange\", function () {\n                if (document.readyState === \"complete\") {\n                    attachBannerHandlers();\n                }\n            });\n            window.attachEvent(\"onload\", attachBannerHandlers);\n        } else {\n            if (document.readyState === \"complete\") {\n                attachBannerHandlers();\n            }\n            window.onload = attachBannerHandlers;\n        }\n    }\n\n    // Initialize consent helpers\n    initSlimStatBanner();\n    setupConsentUpgradeHandler();\n})();\n"],
  "mappings": "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",
  "names": ["SlimStat", "BASE64_KEY_STR", "fingerprintHash", "lastPageviewPayload", "lastPageviewSentAt", "inflightPageview", "requestQueue", "queueInFlight", "MAX_QUEUE_ATTEMPTS", "QUEUE_HIGH_WATERMARK", "lastInteractionPayload", "lastInteractionTime", "PENDING_INTERACTIONS_LIMIT", "pendingInteractions", "bufferInteraction", "raw", "flushPendingInteractions", "params", "payload", "sendToServer", "OFFLINE_KEY", "loadOfflineQueue", "arr", "saveOfflineQueue", "utf8Encode", "string", "utftext", "n", "c", "base64Encode", "input", "output", "i", "chr1", "chr2", "chr3", "enc1", "enc2", "enc3", "enc4", "isEmpty", "v", "t", "anySubstring", "str", "needles", "getCookie", "name", "value", "parts", "addEvent", "obj", "type", "fn", "getServerLatency", "timing", "getPagePerformance", "getComponentValue", "components", "key", "def", "extractSlimStatParams", "meta", "scripts", "match", "initFingerprintHash", "result", "buildSlimStatData", "hasComponents", "screenres", "tzOffset", "useBeacon", "opts", "item", "isDuplicate", "qItem", "processQueue", "done", "success", "delay", "processQueueItem", "callback", "transports", "endpoints", "selected", "order", "sendXHR", "url", "onFail", "xhrOpts", "xhr", "parsed", "trySend", "method", "ok", "trackInteraction", "event", "note", "minimal", "buildInteractionRaw", "target", "noteObj", "resourceUrl", "node", "p", "val", "title", "idAttr", "doNotTrack", "classes", "position", "fingerprintParam", "now", "sent", "FP_EXCLUDES", "lastConsentSnapshot", "isFunction", "isObject", "getCookieStrict", "safeName", "pattern", "detectRealCookieBannerConsent", "category", "rcbConsent", "rcbNew", "decision", "rcb", "consent", "legacy", "legacyVal", "possibleNames", "normalized", "detectWPConsentAPI", "consentObj", "detectSlimStatBanner", "consentCookieName", "emitConsentEvent", "detail", "fallback", "maybeEmitConsentChange", "snapshot", "hasPageviewId", "slimstatConsentAllowed", "options", "s", "anonMode", "setCookie", "anonymizeIP", "hashIP", "integrationKey", "consentLevel", "dntEnabled", "blocked", "collectsPII", "requiresCmpCheck", "cmpAllows", "jsConsent", "cookieName", "bannerConsent", "cmpGranted", "anonDecision", "noPii", "denied", "allowedResult", "buildPageviewBase", "base", "sendPageview", "requestKey", "consentDecision", "isNavigationEvent", "isConsentRetry", "payloadBase", "waitForId", "resetPageviewFlags", "consentUpgradeParam", "run", "fpPromise", "storeOffline", "offline", "flushOfflineQueue", "batchSize", "toRemove", "j", "setupNavigationHooks", "originalPush", "originalReplace", "res", "setupClickDelegation", "helpers", "matches", "arg", "finalized", "pageviewInProgress", "currentSlimStatParams", "finalizedPageviews", "inFlightFinalizations", "finalizationInProgress", "lastFinalizationReason", "lastFinalizationTime", "FINALIZATION_COOLDOWN", "finalizeCurrent", "reason", "lastParams", "observer", "serialized", "selectedCategory", "retryKey", "consentRetried", "shouldTrack", "tryTrackIfAllowed", "retryTimestampKey", "lastRetryTime", "timeSinceLastRetry", "requestKeyCheck", "e", "cat", "allowed", "rcbHandlerDebounceTimer", "rcbHandlerLastCall", "handleRCBConsentChange", "categoryConsent", "consentCheck", "timeSinceLastCall", "debounceDelay", "debouncedFinalize", "finalizationTimeout", "placeholderPayload", "oldPathname", "oldSearch", "newPathname", "newSearch", "stateChangeHandler", "isReplace", "originalFunc", "originalArgs", "args", "setupConsentUpgradeHandler", "consentUpgradeSent", "consentUpgradeRetryCount", "initialConsentState", "consentStateInitialized", "rcbUpgradePollingDone", "detectRCBConsentLocal", "initConsentBaseline", "consentUpgradeInProgress", "handleConsentGranted", "pageviewIdWithChecksum", "pageviewIdNumeric", "ajaxUrl", "requestData", "consentEventHandled", "lastConsentEventTime", "hasRCBConsent", "initSlimStatBanner", "bannerInitialized", "attachBannerHandlers", "banner", "buttons", "button", "submitBannerDecision", "bannerEl", "nonce", "cookiePath", "expiry", "cookie", "evt", "revokeXhr"]
}
